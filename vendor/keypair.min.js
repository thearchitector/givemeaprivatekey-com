/**
 * @license
  New BSD License (3-clause)
  Copyright (c) 2010, Digital Bazaar, Inc.
  All rights reserved.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:
      * Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.
      * Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.
      * Neither the name of Digital Bazaar, Inc. nor the
        names of its contributors may be used to endorse or promote products
        derived from this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  DISCLAIMED. IN NO EVENT SHALL DIGITAL BAZAAR BE LIABLE FOR ANY
  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
  var forge={},aes=forge.aes={},md=forge.md={},pki=forge.pki={},rsa=forge.pki.rsa=forge.rsa={};(util=forge.util={}).fillString=function(t,e){for(var r="";e>0;)1&e&&(r+=t),(e>>>=1)>0&&(t+=t);return r};var sha1=forge.sha1=forge.md.sha1={},_padding=null,_initialized=!1,_init=function(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_initialized=!0},_update=function(t,e,r){for(var i,n,o,a,s,u,f,h=r.length();h>=64;){for(n=t.h0,o=t.h1,a=t.h2,s=t.h3,u=t.h4,f=0;f<16;++f)i=r.getInt32(),e[f]=i,i=(n<<5|n>>>27)+(s^o&(a^s))+u+1518500249+i,u=s,s=a,a=o<<30|o>>>2,o=n,n=i;for(;f<20;++f)i=(i=e[f-3]^e[f-8]^e[f-14]^e[f-16])<<1|i>>>31,e[f]=i,i=(n<<5|n>>>27)+(s^o&(a^s))+u+1518500249+i,u=s,s=a,a=o<<30|o>>>2,o=n,n=i;for(;f<32;++f)i=(i=e[f-3]^e[f-8]^e[f-14]^e[f-16])<<1|i>>>31,e[f]=i,i=(n<<5|n>>>27)+(o^a^s)+u+1859775393+i,u=s,s=a,a=o<<30|o>>>2,o=n,n=i;for(;f<40;++f)i=(i=e[f-6]^e[f-16]^e[f-28]^e[f-32])<<2|i>>>30,e[f]=i,i=(n<<5|n>>>27)+(o^a^s)+u+1859775393+i,u=s,s=a,a=o<<30|o>>>2,o=n,n=i;for(;f<60;++f)i=(i=e[f-6]^e[f-16]^e[f-28]^e[f-32])<<2|i>>>30,e[f]=i,i=(n<<5|n>>>27)+(o&a|s&(o^a))+u+2400959708+i,u=s,s=a,a=o<<30|o>>>2,o=n,n=i;for(;f<80;++f)i=(i=e[f-6]^e[f-16]^e[f-28]^e[f-32])<<2|i>>>30,e[f]=i,i=(n<<5|n>>>27)+(o^a^s)+u+3395469782+i,u=s,s=a,a=o<<30|o>>>2,o=n,n=i;t.h0+=n,t.h1+=o,t.h2+=a,t.h3+=s,t.h4+=u,h-=64}};sha1.create=function(){_initialized||_init();var t=null,e=forge.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,start:function(){i.messageLength=0,e=forge.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}}};return i.start(),i.update=function(n,o){"utf8"===o&&(n=forge.util.encodeUtf8(n)),i.messageLength+=n.length,e.putBytes(n),_update(t,r,e),(e.read>2048||0===e.length())&&e.compact()},i.digest=function(){var n=i.messageLength,o=forge.util.createBuffer();o.putBytes(e.bytes()),o.putBytes(_padding.substr(0,64-(n+8)%64)),o.putInt32(n>>>29&255),o.putInt32(n<<3&4294967295);var a={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};_update(a,r,o);var s=forge.util.createBuffer();return s.putInt32(a.h0),s.putInt32(a.h1),s.putInt32(a.h2),s.putInt32(a.h3),s.putInt32(a.h4),s},i},util.ByteBuffer=function(t){this.data=t||"",this.read=0},util.ByteBuffer.prototype.length=function(){return this.data.length-this.read},util.ByteBuffer.prototype.isEmpty=function(){return this.data.length-this.read==0},util.ByteBuffer.prototype.putByte=function(t){this.data+=String.fromCharCode(t)},util.ByteBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)1&e&&(r+=t),(e>>>=1)>0&&(t+=t);this.data=r},util.ByteBuffer.prototype.putBytes=function(t){this.data+=t},util.ByteBuffer.prototype.putString=function(t){this.data+=util.encodeUtf8(t)},util.ByteBuffer.prototype.putInt16=function(t){this.data+=String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)},util.ByteBuffer.prototype.putInt24=function(t){this.data+=String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)},util.ByteBuffer.prototype.putInt32=function(t){this.data+=String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)},util.ByteBuffer.prototype.putInt16Le=function(t){this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)},util.ByteBuffer.prototype.putInt24Le=function(t){this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)},util.ByteBuffer.prototype.putInt32Le=function(t){this.data+=String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255)},util.ByteBuffer.prototype.putInt=function(t,e){do{e-=8,this.data+=String.fromCharCode(t>>e&255)}while(e>0)},util.ByteBuffer.prototype.putBuffer=function(t){this.data+=t.getBytes()},util.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},util.ByteBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},util.ByteBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},util.ByteBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},util.ByteBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},util.ByteBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},util.ByteBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},util.ByteBuffer.prototype.getInt=function(t){var e=0;do{e=(e<<t)+this.data.charCodeAt(this.read++),t-=8}while(t>0);return e},util.ByteBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},util.ByteBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},util.ByteBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},util.ByteBuffer.prototype.setAt=function(t,e){this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1)},util.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},util.ByteBuffer.prototype.copy=function(){var t=util.createBuffer(this.data);return t.read=this.read,t},util.ByteBuffer.prototype.compact=function(){this.read>0&&(this.data=this.data.slice(this.read),this.read=0)},util.ByteBuffer.prototype.clear=function(){this.data="",this.read=0},util.ByteBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);this.data=this.data.substr(this.read,e),this.read=0},util.ByteBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t},util.ByteBuffer.prototype.toString=function(){return util.decodeUtf8(this.bytes())},util.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=util.encodeUtf8(t)),new util.ByteBuffer(t)};var crypto,prng=forge.prng={};try{crypto=require("crypto")}catch(t){}prng.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0},r=t.md,i=new Array(32),n=0;n<32;++n)i[n]=r.create();function o(){if(e.pools[0].messageLength>=32)return a();var t=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(t)),a()}function a(){var t=forge.md.sha1.create();t.update(e.pools[0].digest().getBytes()),e.pools[0].start();for(var r=1,i=1;i<32;++i)(r=31===r?2147483648:r<<2)%e.reseeds==0&&(t.update(e.pools[i].digest().getBytes()),e.pools[i].start());var n=t.digest().getBytes();t.start(),t.update(n);var o=t.digest().getBytes();e.key=e.plugin.formatKey(n),e.seed=e.plugin.formatSeed(o),++e.reseeds,e.generated=0,e.time=+new Date}function s(t){var e=forge.util.createBuffer();if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var r=new Uint32Array(t/4);try{window.crypto.getRandomValues(r);for(var i=0;i<r.length;++i)e.putInt32(r[i])}catch(t){}}if(e.length()<t)for(var n,o,a,s=Math.floor(65535*Math.random());e.length()<t;){o=16807*(65535&s),o+=(32767&(n=16807*(s>>16)))<<16,s=4294967295&(o=(2147483647&(o+=n>>15))+(o>>31));for(i=0;i<3;++i)a=s>>>(i<<3),a^=Math.floor(255*Math.random()),e.putByte(255&a)}return e.getBytes()}return e.pools=i,e.pool=0,e.generate=function(t,r){if(!r)return e.generateSync(t);var i=e.plugin.cipher,n=e.plugin.increment,o=e.plugin.formatKey,s=e.plugin.formatSeed,u=forge.util.createBuffer();!function f(h){if(h)return r(h);if(u.length()>=t)return r(null,u.getBytes(t));if(e.generated>=1048576){var p=+new Date;(null===e.time||p-e.time>100)&&(e.key=null)}if(null===e.key)return function(t){if(e.pools[0].messageLength>=32)return a(),t();var r=32-e.pools[0].messageLength<<5;e.seedFile(r,(function(r,i){if(r)return t(r);e.collect(i),a(),t()}))}(f);var d=i(e.key,e.seed);e.generated+=d.length,u.putBytes(d),e.key=o(i(e.key,n(e.seed))),e.seed=s(i(e.key,e.seed)),forge.util.setImmediate(f)}()},e.generateSync=function(t){for(var r=e.plugin.cipher,i=e.plugin.increment,n=e.plugin.formatKey,a=e.plugin.formatSeed,s=forge.util.createBuffer();s.length()<t;){if(e.generated>=1048576){var u=+new Date;(null===e.time||u-e.time>100)&&(e.key=null)}null===e.key&&o();var f=r(e.key,e.seed);e.generated+=f.length,s.putBytes(f),e.key=n(r(e.key,i(e.seed))),e.seed=a(r(e.key,e.seed))}return s.getBytes(t)},e.seedFile=function(t,e){try{e(null,s(t))}catch(t){e(t)}},e.seedFileSync=s,e.collect=function(t){for(var r=t.length,i=0;i<r;++i)e.pools[e.pool].update(t.substr(i,1)),e.pool=31===e.pool?0:e.pool+1},e.collectInt=function(t,r){for(var i="",n=0;n<r;n+=8)i+=String.fromCharCode(t>>n&255);e.collect(i)},e.registerWorker=function(t){if(t===self)e.seedFile=function(t,e){self.addEventListener("message",(function t(r){var i=r.data;i.forge&&i.forge.prng&&(self.removeEventListener("message",t),e(i.forge.prng.err,i.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:t}}})};else{t.addEventListener("message",(function(r){var i=r.data;i.forge&&i.forge.prng&&e.seedFile(i.forge.prng.needed,(function(e,r){t.postMessage({forge:{prng:{err:e,bytes:r}}})}))}))}},e};var sbox,isbox,rcon,mix,imix,init=!1,Nb=4,initialize=function(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;sbox=new Array(256),isbox=new Array(256),mix=new Array(4),imix=new Array(4);for(e=0;e<4;++e)mix[e]=new Array(256),imix[e]=new Array(256);var r,i,n,o,a,s,u,f=0,h=0;for(e=0;e<256;++e){o=(o=h^h<<1^h<<2^h<<3^h<<4)>>8^255&o^99,sbox[f]=o,isbox[o]=f,s=(a=t[o])<<24^o<<16^o<<8^o^a,u=((r=t[f])^(i=t[r])^(n=t[i]))<<24^(f^n)<<16^(f^i^n)<<8^f^r^n;for(var p=0;p<4;++p)mix[p][f]=s,imix[p][o]=u,s=s<<24|s>>>8,u=u<<24|u>>>8;0===f?f=h=1:(f=r^t[t[t[r^n]]],h^=t[t[h]])}},expandKey=function(t,e){for(var r,i=t.slice(0),n=1,o=i.length,a=Nb*(o+6+1),s=o;s<a;++s)r=i[s-1],s%o==0?(r=sbox[r>>>16&255]<<24^sbox[r>>>8&255]<<16^sbox[255&r]<<8^sbox[r>>>24]^rcon[n]<<24,n++):o>6&&s%o==4&&(r=sbox[r>>>24]<<24^sbox[r>>>16&255]<<16^sbox[r>>>8&255]<<8^sbox[255&r]),i[s]=i[s-o]^r;if(e){for(var u,f=imix[0],h=imix[1],p=imix[2],d=imix[3],g=i.slice(0),l=(s=0,(a=i.length)-Nb);s<a;s+=Nb,l-=Nb)if(0===s||s===a-Nb)g[s]=i[l],g[s+1]=i[l+3],g[s+2]=i[l+2],g[s+3]=i[l+1];else for(var c=0;c<Nb;++c)u=i[l+c],g[s+(3&-c)]=f[sbox[u>>>24]]^h[sbox[u>>>16&255]]^p[sbox[u>>>8&255]]^d[sbox[255&u]];i=g}return i};forge.aes._expandKey=function(t,e){return init||initialize(),expandKey(t,e)};var _updateBlock=function(t,e,r,i){var n,o,a,s,u,f,h,p,d,g,l,c,y=t.length/4-1;i?(n=imix[0],o=imix[1],a=imix[2],s=imix[3],u=isbox):(n=mix[0],o=mix[1],a=mix[2],s=mix[3],u=sbox),f=e[0]^t[0],h=e[i?3:1]^t[1],p=e[2]^t[2],d=e[i?1:3]^t[3];for(var m=3,B=1;B<y;++B)g=n[f>>>24]^o[h>>>16&255]^a[p>>>8&255]^s[255&d]^t[++m],l=n[h>>>24]^o[p>>>16&255]^a[d>>>8&255]^s[255&f]^t[++m],c=n[p>>>24]^o[d>>>16&255]^a[f>>>8&255]^s[255&h]^t[++m],d=n[d>>>24]^o[f>>>16&255]^a[h>>>8&255]^s[255&p]^t[++m],f=g,h=l,p=c;r[0]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[255&d]^t[++m],r[i?3:1]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[d>>>8&255]<<8^u[255&f]^t[++m],r[2]=u[p>>>24]<<24^u[d>>>16&255]<<16^u[f>>>8&255]<<8^u[255&h]^t[++m],r[i?1:3]=u[d>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[255&p]^t[++m]};forge.aes._updateBlock=_updateBlock;var prng_aes={},_prng_aes_output=new Array(4),_prng_aes_buffer=forge.util.createBuffer();prng_aes.formatKey=function(t){var e=forge.util.createBuffer(t);return(t=new Array(4))[0]=e.getInt32(),t[1]=e.getInt32(),t[2]=e.getInt32(),t[3]=e.getInt32(),forge.aes._expandKey(t,!1)},prng_aes.formatSeed=function(t){var e=forge.util.createBuffer(t);return(t=new Array(4))[0]=e.getInt32(),t[1]=e.getInt32(),t[2]=e.getInt32(),t[3]=e.getInt32(),t},prng_aes.cipher=function(t,e){return forge.aes._updateBlock(t,e,_prng_aes_output,!1),_prng_aes_buffer.putInt32(_prng_aes_output[0]),_prng_aes_buffer.putInt32(_prng_aes_output[1]),_prng_aes_buffer.putInt32(_prng_aes_output[2]),_prng_aes_buffer.putInt32(_prng_aes_output[3]),_prng_aes_buffer.getBytes()},prng_aes.increment=function(t){return++t[3],t},prng_aes.md=forge.md.sha1;var dbits,_ctx=forge.prng.create(prng_aes);if(!("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues||("undefined"==typeof window||window.document,_ctx.collectInt(+new Date,32),"undefined"==typeof navigator))){var _navBytes="";for(var key in navigator)try{"string"==typeof navigator[key]&&(_navBytes+=navigator[key])}catch(t){}_ctx.collect(_navBytes),_navBytes=null}forge.random=_ctx,forge.random.getBytes=function(t,e){return forge.random.generate(t,e)},forge.pki.rsa.createKeyPairGenerationState=function(t,e){"string"==typeof t&&(t=parseInt(t,10));var r={state:0,bits:t=t||1024,rng:{nextBytes:function(t){for(var e=forge.random.getBytes(t.length),r=0;r<t.length;++r)t[r]=e.charCodeAt(r)}},eInt:e||65537,e:new BigInteger(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null};return r.e.fromInt(r.eInt),r};var canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(t,e,r){this.data=[],null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,r,i,n,o){for(;--o>=0;){var a=e*this.data[t++]+r.data[i]+n;n=Math.floor(a/67108864),r.data[i++]=67108863&a}return n}function am2(t,e,r,i,n,o){for(var a=32767&e,s=e>>15;--o>=0;){var u=32767&this.data[t],f=this.data[t++]>>15,h=s*u+f*a;n=((u=a*u+((32767&h)<<15)+r.data[i]+(1073741823&n))>>>30)+(h>>>15)+s*f+(n>>>30),r.data[i++]=1073741823&u}return n}function am3(t,e,r,i,n,o){for(var a=16383&e,s=e>>14;--o>=0;){var u=16383&this.data[t],f=this.data[t++]>>14,h=s*u+f*a;n=((u=a*u+((16383&h)<<14)+r.data[i]+n)>>28)+(h>>14)+s*f,r.data[i++]=268435455&u}return n}"undefined"==typeof navigator?(BigInteger.prototype.am=am3,dbits=28):j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var rr,vv,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var r=BI_RC[t.charCodeAt(e)];return null==r?-1:r}function bnpCopyTo(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,n=!1,o=0;--i>=0;){var a=8==r?255&t[i]:intAt(t,i);a<0?"-"==t.charAt(i)&&(n=!0):(n=!1,0==o?this.data[this.t++]=a:o+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&128&t[0]&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,n=!1,o="",a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(r=this.data[a]>>s)>0&&(n=!0,o=int2char(r));a>=0;)s<e?(r=(this.data[a]&(1<<s)-1)<<e-s,r|=this.data[--a]>>(s+=this.DB-e)):(r=this.data[a]>>(s-=e)&i,s<=0&&(s+=this.DB,--a)),r>0&&(n=!0),n&&(o+=int2char(r));return n?o:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this.data[r]-t.data[r]))return e;return 0}function nbits(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var r,i=t%this.DB,n=this.DB-i,o=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)e.data[r+a+1]=this.data[r]>>n|s,s=(this.data[r]&o)<<i;for(r=a-1;r>=0;--r)e.data[r]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var i=t%this.DB,n=this.DB-i,o=(1<<i)-1;e.data[0]=this.data[r]>>i;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&o)<<n,e.data[a-r]=this.data[a]>>i;i>0&&(e.data[this.t-r-1]|=(this.s&o)<<n),e.t=this.t-r,e.clamp()}}function bnpSubTo(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]-t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e.data[r++]=this.DV+i:i>0&&(e.data[r++]=i),e.t=r,e.clamp()}function bnpMultiplyTo(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+r.t]=r.am(0,i.data[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var o=nbi(),a=this.s,s=t.s,u=this.DB-nbits(i.data[i.t-1]);u>0?(i.lShiftTo(u,o),n.lShiftTo(u,r)):(i.copyTo(o),n.copyTo(r));var f=o.t,h=o.data[f-1];if(0!=h){var p=h*(1<<this.F1)+(f>1?o.data[f-2]>>this.F2:0),d=this.FV/p,g=(1<<this.F1)/p,l=1<<this.F2,c=r.t,y=c-f,m=null==e?nbi():e;for(o.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),BigInteger.ONE.dlShiftTo(f,m),m.subTo(o,o);o.t<f;)o.data[o.t++]=0;for(;--y>=0;){var B=r.data[--c]==h?this.DM:Math.floor(r.data[c]*d+(r.data[c-1]+l)*g);if((r.data[c]+=o.am(0,B,r,y,0,f))<B)for(o.dlShiftTo(y,m),r.subTo(m,r);r.data[c]<--B;)r.subTo(m,r)}null!=e&&(r.drShiftTo(f,e),a!=s&&BigInteger.ZERO.subTo(e,e)),r.t=f,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(BigInteger.ZERO)>0&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){if(this.t<1)return 0;var t=this.data[0];if(!(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(BigInteger.ZERO)>0&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t.data[e],i=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,i,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnpIsEven(){return 0==(this.t>0?1&this.data[0]:this.s)}function bnpExp(t,e){if(t>4294967295||t<1)return BigInteger.ONE;var r=nbi(),i=nbi(),n=e.convert(this),o=nbits(t)-1;for(n.copyTo(r);--o>=0;)if(e.sqrTo(r,i),(t&1<<o)>0)e.mulTo(i,n,r);else{var a=r;r=i,i=a}return e.revert(r)}function bnModPowInt(t,e){var r;return r=t<256||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,r)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return 0==this.t?this.s:this.data[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this.data[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=nbv(r),n=nbi(),o=nbi(),a="";for(this.divRemTo(i,n,o);n.signum()>0;)a=(r+o.intValue()).toString(t).substr(1)+a,n.divRemTo(i,n,o);return o.intValue().toString(t)+a}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,o=0,a=0,s=0;s<t.length;++s){var u=intAt(t,s);u<0?"-"==t.charAt(s)&&0==this.signum()&&(n=!0):(a=e*a+u,++o>=r&&(this.dMultiply(i),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),n&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var i=new Array,n=7&t;i.length=1+(t>>3),e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function bnToByteArray(){var t=this.t,e=new Array;e[0]=this.s;var r,i=this.DB-t*this.DB%8,n=0;if(t-- >0)for(i<this.DB&&(r=this.data[t]>>i)!=(this.s&this.DM)>>i&&(e[n++]=r|this.s<<this.DB-i);t>=0;)i<8?(r=(this.data[t]&(1<<i)-1)<<8-i,r|=this.data[--t]>>(i+=this.DB-8)):(r=this.data[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),128&r&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(e[n++]=r);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,e,r){var i,n,o=Math.min(t.t,this.t);for(i=0;i<o;++i)r.data[i]=e(this.data[i],t.data[i]);if(t.t<this.t){for(n=t.s&this.DM,i=o;i<this.t;++i)r.data[i]=e(this.data[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=o;i<t.t;++i)r.data[i]=e(n,t.data[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 65535&t||(t>>=16,e+=16),255&t||(t>>=8,e+=8),15&t||(t>>=4,e+=4),3&t||(t>>=2,e+=2),1&t||++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this.data[t])return t*this.DB+lbit(this.data[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=cbit(this.data[r]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:!!(this.data[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var r=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this.data[r]+t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t.data[r],e.data[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e.data[r++]=i:i<-1&&(e.data[r++]=this.DV+i),e.t=r,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),r=nbi();return this.divRemTo(t,e,r),new Array(e,r)}function bnpDMultiply(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,r){t.multiplyTo(e,r)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,r){var i,n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function bnpMultiplyUpperTo(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r.data[this.t+i-e]=this.am(e-i,t.data[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function bnModPow(t,e){var r,i,n=t.bitLength(),o=nbv(1);if(n<=0)return o;r=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var a=new Array,s=3,u=r-1,f=(1<<r)-1;if(a[1]=i.convert(this),r>1){var h=nbi();for(i.sqrTo(a[1],h);s<=f;)a[s]=nbi(),i.mulTo(h,a[s-2],a[s]),s+=2}var p,d,g=t.t-1,l=!0,c=nbi();for(n=nbits(t.data[g])-1;g>=0;){for(n>=u?p=t.data[g]>>n-u&f:(p=(t.data[g]&(1<<n+1)-1)<<u-n,g>0&&(p|=t.data[g-1]>>this.DB+n-u)),s=r;!(1&p);)p>>=1,--s;if((n-=s)<0&&(n+=this.DB,--g),l)a[p].copyTo(o),l=!1;else{for(;s>1;)i.sqrTo(o,c),i.sqrTo(c,o),s-=2;s>0?i.sqrTo(o,c):(d=o,o=c,c=d),i.mulTo(c,a[p],o)}for(;g>=0&&!(t.data[g]&1<<n);)i.sqrTo(o,c),d=o,o=c,c=d,--n<0&&(n=this.DB-1,--g)}return i.revert(o)}function bnGCD(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(n<o&&(o=n),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function bnpModInt(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this.data[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this.data[i])%t;return r}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var r=t.clone(),i=this.clone(),n=nbv(1),o=nbv(0),a=nbv(0),s=nbv(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(t,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),e?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(t,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(a,n),o.subTo(s,o)):(i.subTo(r,i),e&&a.subTo(n,a),s.subTo(o,s))}return 0!=i.compareTo(BigInteger.ONE)?BigInteger.ZERO:s.compareTo(t)>=0?s.subtract(t):s.signum()<0?(s.addTo(t,s),s.signum()<0?s.add(t):s):s}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(t){var e,r=this.abs();if(1==r.t&&r.data[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(r.data[0]==lowprimes[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<lowprimes.length;){for(var i=lowprimes[e],n=e+1;n<lowprimes.length&&i<lplim;)i*=lowprimes[n++];for(i=r.modInt(i);e<n;)if(i%lowprimes[e++]==0)return!1}return r.millerRabin(t)}function bnpMillerRabin(t){var e=this.subtract(BigInteger.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var i=e.shiftRight(r);(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length);for(var n=nbi(),o=0;o<t;++o){n.fromInt(lowprimes[o]);var a=n.modPow(i,this);if(0!=a.compareTo(BigInteger.ONE)&&0!=a.compareTo(e)){for(var s=1;s++<r&&0!=a.compareTo(e);)if(0==(a=a.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=a.compareTo(e))return!1}}return!0}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,forge.jsbn=forge.jsbn||{},forge.jsbn.BigInteger=BigInteger;var util=forge.util=forge.util||{};"undefined"!=typeof process&&process.nextTick?(util.nextTick=process.nextTick,"function"==typeof setImmediate?util.setImmediate=setImmediate:util.setImmediate=util.nextTick):"function"==typeof setImmediate?(util.setImmediate=setImmediate,util.nextTick=function(t){return setImmediate(t)}):(util.setImmediate=function(t){setTimeout(t,0)},util.nextTick=util.setImmediate);var _modPow=function(t,e,r){var i;if(r)i=t.modPow(e.e,e.n);else{e.dP||(e.dP=e.d.mod(e.p.subtract(BigInteger.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(BigInteger.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));for(var n=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);n.compareTo(o)<0;)n=n.add(e.p);i=n.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o)}return i};util.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},util.decodeUtf8=function(t){return decodeURIComponent(escape(t))},util.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=util.encodeUtf8(t)),new util.ByteBuffer(t)},util.hexToBytes=function(t){var e="",r=0;for(!0&t.length&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e},pki.rsa.decrypt=function(t,e,r,i){var n=Math.ceil(e.n.bitLength()/8);if(t.length!=n)throw{message:"Encrypted message length is invalid.",length:t.length,expected:n};for(var o=new BigInteger(forge.util.createBuffer(t).toHex(),16),a=_modPow(o,e,r).toString(16),s=forge.util.createBuffer(),u=n-Math.ceil(a.length/2);u>0;)s.putByte(0),--u;if(s.putBytes(forge.util.hexToBytes(a)),!1!==i){var f=s.getByte(),h=s.getByte();if(0!==f||r&&0!==h&&1!==h||!r&&2!=h||r&&0===h&&void 0===i)throw{message:"Encryption block is invalid."};var p=0;if(0===h){p=n-3-i;for(var d=0;d<p;++d)if(0!==s.getByte())throw{message:"Encryption block is invalid."}}else if(1===h)for(p=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++p}else if(2===h)for(p=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++p}if(0!==s.getByte()||p!==n-3-s.length())throw{message:"Encryption block is invalid."}}return s.getBytes()},pki.rsa.encrypt=function(t,e,r){var i=r,n=forge.util.createBuffer(),o=Math.ceil(e.n.bitLength()/8);if(!1!==r&&!0!==r){if(t.length>o-11)throw{message:"Message is too long to encrypt.",length:t.length,max:o-11};n.putByte(0),n.putByte(r);var a,s=o-3-t.length;if(0===r||1===r){i=!1,a=0===r?0:255;for(var u=0;u<s;++u)n.putByte(a)}else{i=!0;for(u=0;u<s;++u)a=Math.floor(255*Math.random())+1,n.putByte(a)}n.putByte(0)}n.putBytes(t);for(var f=new BigInteger(n.toHex(),16),h=_modPow(f,e,i).toString(16),p=forge.util.createBuffer(),d=o-Math.ceil(h.length/2);d>0;)p.putByte(0),--d;return p.putBytes(forge.util.hexToBytes(h)),p.getBytes()},pki.rsa.setPrivateKey=function(t,e,r,i,n,o,a,s){var u={n:t,e:e,d:r,p:i,q:n,dP:o,dQ:a,qInv:s,decrypt:function(t){return pki.rsa.decrypt(t,u,!1)},sign:function(t,e){var r=!1;void 0===e&&(e={encode:emsaPkcs1v15encode},r=1);var i=e.encode(t,u.n.bitLength());return pki.rsa.encrypt(i,u,r)}};return u};var _getValueLength=function(t){var e=t.getByte();if(128!=e)return 128&e?t.getInt((127&e)<<3):e},asn1=forge.asn1=forge.asn1||{};asn1.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},asn1.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},asn1.create=function(t,e,r,i){if(i.constructor==Array){for(var n=[],o=0;o<i.length;++o)void 0!==i[o]&&n.push(i[o]);i=n}return{tagClass:t,type:e,constructed:r,composed:r||i.constructor==Array,value:i}},asn1.fromDer=function(t){if(t.constructor==String&&(t=forge.util.createBuffer(t)),t.length()<2)throw{message:"Too few bytes to parse DER.",bytes:t.length()};var e,r=t.getByte(),i=192&r,n=31&r,o=_getValueLength(t);if(t.length()<o)throw{message:"Too few bytes to read ASN.1 value.",detail:t.length()+" < "+o};var a=!(32&~r),s=a;if(!s&&i===asn1.Class.UNIVERSAL&&n===asn1.Type.BITSTRING&&o>1){var u=t.read;if(0===t.getByte()){var f=192&(r=t.getByte());if(f===asn1.Class.UNIVERSAL||f===asn1.Class.CONTEXT_SPECIFIC)try{(s=_getValueLength(t)===o-(t.read-u))&&(++u,--o)}catch(t){}}t.read=u}if(s)if(e=[],void 0===o)for(;;){if(t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2);break}e.push(asn1.fromDer(t))}else for(var h=t.length();o>0;)e.push(asn1.fromDer(t)),o-=h-t.length(),h=t.length();else{if(void 0===o)throw{message:"Non-constructed ASN.1 object of indefinite length."};if(n===asn1.Type.BMPSTRING){e="";for(var p=0;p<o;p+=2)e+=String.fromCharCode(t.getInt16())}else e=t.getBytes(o)}return asn1.create(i,n,a,e)},asn1.toDer=function(t){var e=forge.util.createBuffer(),r=t.tagClass|t.type,i=forge.util.createBuffer();if(t.composed){t.constructed?r|=32:i.putByte(0);for(var n=0;n<t.value.length;++n)void 0!==t.value[n]&&i.putBuffer(asn1.toDer(t.value[n]))}else if(t.type===asn1.Type.BMPSTRING)for(n=0;n<t.value.length;++n)i.putInt16(t.value.charCodeAt(n));else i.putBytes(t.value);if(e.putByte(r),i.length()<=127)e.putByte(127&i.length());else{var o=i.length(),a="";do{a+=String.fromCharCode(255&o),o>>>=8}while(o>0);e.putByte(128|a.length);for(n=a.length-1;n>=0;--n)e.putByte(a.charCodeAt(n))}return e.putBuffer(i),e},pki.rsa.setPublicKey=function(t,e){var r={n:t,e:e,encrypt:function(t){return pki.rsa.encrypt(t,r,2)},verify:function(t,e,i){var n=void 0===i&&void 0,o=pki.rsa.decrypt(e,r,!0,n);return void 0===i?t===asn1.fromDer(o).value[1].value:i.verify(t,o,r.n.bitLength())}};return r};var GCD_30_DELTA=[6,4,2,4,2,4,6,2];function _generateKeyPair(t,e,r){if("function"==typeof e&&(r=e,e={}),"undefined"==typeof Worker){return function e(){if(forge.pki.rsa.stepKeyPairGenerationState(t,10))return r(null,t.keys);forge.util.setImmediate(e)}()}var i=e.workers||2,n=e.workLoad||100,o=30*n/8,a=e.workerScript||"forge/prime.worker.js",s=new BigInteger(null);s.fromInt(30);var u=function(t,e){return t|e};function f(){h(t.pBits,(function(e,i){if(e)return r(e);t.p=i,h(t.qBits,p)}))}function h(e,r){for(var f=[],h=0;h<i;++h)f[h]=new Worker(a);var p=d();for(h=0;h<i;++h)f[h].addEventListener("message",l);function d(){var r=e-1,i=new BigInteger(e,t.rng);return i.testBit(r)||i.bitwiseTo(BigInteger.ONE.shiftLeft(r),u,i),i.dAddOffset(31-i.mod(s).byteValue(),0),i}var g=!1;function l(i){if(!g){0;var a=i.data;if(a.found){for(var s=0;s<f.length;++s)f[s].terminate();return g=!0,r(null,new BigInteger(a.prime,16))}p.bitLength()>e&&(p=d());var u=p.toString(16);i.target.postMessage({e:t.eInt,hex:u,workLoad:n}),p.dAddOffset(o,0)}}}function p(e,i){if(t.q=i,t.p.compareTo(t.q)<0){var n=t.p;t.p=t.q,t.q=n}if(t.p1=t.p.subtract(BigInteger.ONE),t.q1=t.q.subtract(BigInteger.ONE),t.phi=t.p1.multiply(t.q1),0!==t.phi.gcd(t.e).compareTo(BigInteger.ONE))return t.p=t.q=null,void f();if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits)return t.q=null,void h(t.qBits,p);var o=t.e.modInverse(t.phi);t.keys={privateKey:forge.pki.rsa.setPrivateKey(t.n,t.e,o,t.p,t.q,o.mod(t.p1),o.mod(t.q1),t.q.modInverse(t.p)),publicKey:forge.pki.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}f()}pki.rsa.stepKeyPairGenerationState=function(t,e){var r=new BigInteger(null);r.fromInt(30);for(var i,n=0,o=function(t,e){return t|e},a=+new Date,s=0;null===t.keys&&(e<=0||s<e);){if(0===t.state){var u=null===t.p?t.pBits:t.qBits,f=u-1;0===t.pqState?(t.num=new BigInteger(u,t.rng),t.num.testBit(f)||t.num.bitwiseTo(BigInteger.ONE.shiftLeft(f),o,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):1===t.pqState?t.num.bitLength()>u?t.pqState=0:t.num.isProbablePrime(1)?++t.pqState:t.num.dAddOffset(GCD_30_DELTA[n++%8],0):2===t.pqState?t.pqState=0===t.num.subtract(BigInteger.ONE).gcd(t.e).compareTo(BigInteger.ONE)?3:0:3===t.pqState&&(t.pqState=0,t.num.isProbablePrime(10)&&(null===t.p?t.p=t.num:t.q=t.num,null!==t.p&&null!==t.q&&++t.state),t.num=null)}else if(1===t.state)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(2===t.state)t.p1=t.p.subtract(BigInteger.ONE),t.q1=t.q.subtract(BigInteger.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(3===t.state)0===t.phi.gcd(t.e).compareTo(BigInteger.ONE)?++t.state:(t.p=null,t.q=null,t.state=0);else if(4===t.state)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(5===t.state){var h=t.e.modInverse(t.phi);t.keys={privateKey:forge.pki.rsa.setPrivateKey(t.n,t.e,h,t.p,t.q,h.mod(t.p1),h.mod(t.q1),t.q.modInverse(t.p)),publicKey:forge.pki.rsa.setPublicKey(t.n,t.e)}}s+=(i=+new Date)-a,a=i}return null!==t.keys},pki.rsa.generateKeyPair=function(t,e,r,i){1===arguments.length?"object"==typeof t?(r=t,t=void 0):"function"==typeof t&&(i=t,t=void 0):2===arguments.length?("number"==typeof t?"function"==typeof e?i=e:r=e:(r=t,i=e,t=void 0),e=void 0):3===arguments.length&&("number"==typeof e?"function"==typeof r&&(i=r,r=void 0):(i=r,r=e,e=void 0)),r=r||{},void 0===t&&(t=r.bits||1024),void 0===e&&(e=r.e||65537);var n=pki.rsa.createKeyPairGenerationState(t,e);if(!i)return pki.rsa.stepKeyPairGenerationState(n,0),n.keys;_generateKeyPair(n,r,i)};var _bnToBytes=function(t){var e=t.toString(16);return e[0]>="8"&&(e="00"+e),forge.util.hexToBytes(e)};pki.publicKeyToRSAPublicKey=function(t){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.n)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.e))])};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";util.encode64=function(t,e){for(var r,i,n,o="",a="",s=0;s<t.length;)r=t.charCodeAt(s++),i=t.charCodeAt(s++),n=t.charCodeAt(s++),o+=_base64.charAt(r>>2),o+=_base64.charAt((3&r)<<4|i>>4),isNaN(i)?o+="==":(o+=_base64.charAt((15&i)<<2|n>>6),o+=isNaN(n)?"=":_base64.charAt(63&n)),e&&o.length>e&&(a+=o.substr(0,e)+"\r\n",o=o.substr(e));return a+=o},pki.publicKeyToRSAPublicKeyPem=function(t,e){var r=asn1.toDer(pki.publicKeyToRSAPublicKey(t));return"-----BEGIN RSA PUBLIC KEY-----\r\n"+(r=forge.util.encode64(r.getBytes(),e||64))+"\r\n-----END RSA PUBLIC KEY-----"},pki.privateKeyToAsn1=pki.privateKeyToRSAPrivateKey=function(t){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,String.fromCharCode(0)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.n)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.e)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.d)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.p)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.q)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.dP)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.dQ)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(t.qInv))])},pki.privateKeyToPem=function(t,e){var r=asn1.toDer(pki.privateKeyToAsn1(t));return"-----BEGIN RSA PRIVATE KEY-----\r\n"+(r=forge.util.encode64(r.getBytes(),e||64))+"\r\n-----END RSA PRIVATE KEY-----"};